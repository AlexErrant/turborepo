---
title: Configuring turbo.json
description: Learn how to configure Turborepo through `turbo.json`.
---

import { Callout } from "#/components/Callout";
import { TypeTable } from 'fumadocs-ui/components/type-table'
import Link from "next/link";

Configure the behavior of `turbo` by adding a `turbo.json` file in your workspace's root directory.

<Callout type="info">
Changing your root `turbo.json` file will invalidate the cache for all tasks because it's considered in [the global hash](/TODO-LINK). If you'd like the flexibility to change your configuration without impacting the global hash, you can use [Package Configurations](/TODO-LINK).
</Callout>

## Global options

### `extends`

Extend from the root `turbo.json` to create specific configuration for a package using [Package Configuration](/TODO-LINK).

- Today, the only valid value for `extends` is `["//"]` to indicate inheriting configuration from the root `turbo.json`. Any other keys provided in the Package Configuration will be overridden.
- If `extends` is used in the root `turbo.json`, it will be ignored.

```jsonc title="apps/web/turbo.json"
{
  "extends": ["//"]
}
```

### `globalDependencies`

```jsonc
{
  "globalDependencies": [".env", "tsconfig.json"]
}
```

A list of globs that you want to include in all task hashes. **If any file matching these globs changes, all tasks will miss cache.**

Paths are relative to the location of `turbo.json` and must point to globs that are in your repository. Globs outside of the repository are not supported.

### `globalEnv`

```jsonc
{
  "globalEnv": ["GITHUB_TOKEN", "PACKAGE_VERSION", "NODE_ENV"]
}
```

A list of environment variables that you want to impact the hash of all tasks. Any change to these environment variables will cause all tasks to miss cache.

### `globalPassThroughEnv`

```jsonc
{
  "globalPassThroughEnv": ["AWS_SECRET_KEY", "GITHUB_TOKEN"]
}
```

A list of environment variables that you want to make available to tasks. Using this key opts all tasks into [Strict Environment Variable Mode](/TODO-LINK).

<Callout type="warn">
  **These values will not contribute to the hash by themselves.** If you want
  changes in these variables to cause cache misses, you will need to include
  them in [`env`](#env) or [`globalEnv`](#globalenv).
</Callout>

### `globalDotEnv`

```jsonc
{
  "globalDotEnv": ["**/.env.local", "**/.env"]
}
```

A list of `.env` files whose content impacts the hash of all tasks.

<Callout type="info">
This does not load the variables into the task's runtime. You will still need to load them into your tasks using a framework with built-in `.env` loading or a tool like [`dotenv`](https://www.npmjs.com/package/dotenv).
</Callout>

## Defining tasks

### `pipeline`

Each key in the `pipeline` object is the name of a task that can be executed by [`turbo run`](/repo/docs/reference/run). Turborepo will search the packages described in your [workspace's configuration](/TODO-LINK) for scripts in `package.json` with the name of the task.

Using the rest of the configuration described in the pipeline, Turborepo will run the scripts in the correct order and cache logs and outputs in [the `outputs` key](#outputs) if provided.

In the example below, we've defined three tasks under the pipeline key: `build`, `test`, and `dev`.

```jsonc
{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "build": {
      "dependsOn": ["^build"],
      "outputs": ["dist/**", ".next/**", "!.next/cache/**"]
    },
    "test": {
      "outputs": ["coverage/**"],
      "dependsOn": ["build"],
    },
    "dev": {
      "cache": false,
      "persistent": true
    }
  }
}
```

## Task options

Using the options available in the tasks you define in `pipeline`, you can configure how `turbo` will run your tasks.

### `dependsOn`

A list of tasks that are required to complete before the task begins running.

There are two types of `dependsOn` relationships: with and without `^`.

#### With `^`

Prefixing a string in `dependsOn` with a `^` tells `turbo` that the task must wait for tasks in the package's dependencies to complete first. For example, in the `turbo.json` below:

```jsonc
{
  "pipeline": {
    "build": {
      "dependsOn": ["^build"]
    }
  }
}
```

`turbo` starts at the top of the package graph and recursively visits each package until it finds a package with no internal dependencies. It will then run the `build` task at the end of the dependency chain first, working its way back to the "top" until all tasks `build` tasks are complete in order.

#### Without `^`

Task names without the `^` prefix describe a task that depends on a different task within the same package. For example, in the `turbo.json` below:

```jsonc
{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "test": {
      "dependsOn": ["lint", "build"]
    },

  }
}
```

The `test` task in the `@repo/ui` package will only run after the `lint` and `build` tasks have completed in `@repo/ui`.

### `dotEnv`

A list of `.env` files to include in the task's hash. These files will be included into the hash regardless of whether or not they are included in the `git` index.

```jsonc
{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "build": {
      "dotEnv": [".env.local", ".env"]
    }
  }
}
```

The provided list is **ordered**. The first file will have the highest priority and will override the value of variables that have been set in previous files. In the example above, a variable in `.env.local` that is repeated in `.env` will use the value from `.env.local` for hashing.

<Callout type="info">
This does not load the variables into the task's runtime. You will still need to load them into your tasks using a framework with built-in `.env` loading or a tool like [`dotenv`](https://www.npmjs.com/package/dotenv).
</Callout>

### `env`

The list of environment variables a task depends on.

```jsonc
{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "build": {
      // Value will impact the hash of all build tasks
      "env": ["DATABASE_URL"],
    },
    "web#build": {
      // Value will impact the hash of web's build task
      "env": ["API_SERVICE_KEY"],
    }
  },
}
```

<Callout type="good-to-know">
  Turborepo automatically includes environment variables prefixed by common frameworks through [Framework Detection](/TODO-LINK). For example, if the `web` package is a Next.js project,
  you do not need to specify any environment variables that [start with
  `NEXT_PUBLIC_`](https://nextjs.org/docs/basic-features/environment-variables#exposing-environment-variables-to-the-browser).
</Callout>

### `passThroughEnv`

An allowlist of environment variables that should be made available to this task's runtime. Using this key opts this task into [Strict Environment Variable Mode](/TODO-LINK).

```jsonc
{
  "pipeline": {
    "build": {
      // Values will available within `build` scripts
      "passThroughEnv": ["AWS_SECRET_KEY", "GITHUB_TOKEN"]
    },
  }
}
```

Values provided in `passThroughEnv` do not contribute to the cache key for the task. If you'd like changes to these variables to cause cache misses, you will need to include them in [`env`](#env) or [`globalEnv`](#globalenv).

### `outputs`

A list of file glob patterns relative to the package's `package.json` to cache when the task is successfully completed.

Omitting this key or passing an empty array tells `turbo` to cache nothing (except logs, which are always cached).

```jsonc
{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "build": {
      // Cache all files emitted to the packages's `dist` directory
      "outputs": ["dist/**"],
    },
  }
}
```

### `cache`

Default: `true`

Defines if task outputs should be cached. Setting `cache` to false is useful for long-running "watch" or development mode tasks.

```jsonc
{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "build": {
      // Outputs will be cached since `cache` is not set, defaulting to `true`
      "outputs": [".svelte-kit/**", "dist/**"],
    },
    "dev": {
      // Ensures no outputs are cached when the task is exited
      "cache": false,
      "persistent": true
    }
  }
}
```

### `inputs`

Default: `[]`, all files in the package that are checked into source control

A list of file glob patterns relative to the package's `package.json` to consider when determining if a package has changed. `turbo.json` is **always** considered an input.

```jsonc
{
  "pipeline": {
    "test": {
      // Only run test when .ts, .tsx, or .test.ts files change
      "inputs": ["src/**/*.ts", "src/**/*.tsx", "test/**/*.ts"]
    }
  }
}
```

<Callout type="warn">
  Using the `inputs` key opts you out of `turbo`'s default behavior of considering `.gitignore`. You must reconstruct the globs from `.gitignore` as desired or use `$TURBO_DEFAULT$` to build off of the default behavior.
</Callout>

#### `$TURBO_DEFAULT$`

Because specifying an `inputs` key immediately opts out of the default behavior, you may use
the special string `$TURBO_DEFAULT$` within the `inputs` array to restore `turbo`'s default behavior. This allows you to tweak the default behavior more granularly.

```jsonc
{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "check-types": {
      // Consider all default inputs except the README.md
      "inputs": ["$TURBO_DEFAULT$", "!README.md"]
    }
  }
}
```

### `outputMode`

Default: `full`

Set output logging verbosity. Can be overriden by the [`--output-logs`](/repo/docs/reference/run#--output-logs) CLI option.

| Option        | Description                       |
| ------------- | --------------------------------- |
| `full`        | Displays all logs                 |
| `hash-only`   | Only show the hashes of the tasks |
| `new-only`    | Only show logs from cache misses  |
| `errors-only` | Only show logs from task failures |
| `none`        | Hides all task logs               |

```jsonc
{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "build": {
      "outputMode": "new-only"
    }
  }
}
```

### `persistent`

Default: `false`

Label a task as `persistent` to prevent other tasks from depending on long-running processes.

Because a long-running process won't exit, tasks that would depend on it would never run. Once you've labeled the task as persistent, `turbo` will throw an error if other tasks depend on it.

This option is most useful for development servers or "watch" tasks.

```jsonc
{
  "$schema": "https://turbo.build/schema.json",
  "pipeline": {
    "dev": {
      "persistent": true
    }
  }
}
```
